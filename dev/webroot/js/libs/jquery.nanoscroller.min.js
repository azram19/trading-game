(function(f,j,k){var l,h,m,n,o;n={paneClass:"pane",sliderClass:"slider",sliderMinHeight:20,contentClass:"content",iOSNativeScrolling:!1,preventPageScrolling:!1,disableResize:!1};l="Microsoft Internet Explorer"===j.navigator.appName&&/msie 7./i.test(j.navigator.appVersion)&&j.ActiveXObject;h=null;o=function(){var b,a;b=k.createElement("div");a=b.style;a.position="absolute";a.width="100px";a.height="100px";a.overflow="scroll";a.top="-9999px";k.body.appendChild(b);a=b.offsetWidth-b.clientWidth;k.body.removeChild(b);
return a};m=function(){function b(a,c){this.options=c;h||(h=o());this.el=f(a);this.doc=f(k);this.win=f(j);this.generate();this.createEvents();this.addEvents();this.reset()}b.prototype.preventScrolling=function(a,c){switch(a.type){case "DOMMouseScroll":("down"===c&&0<a.originalEvent.detail||"up"===c&&0>a.originalEvent.detail)&&a.preventDefault();break;case "mousewheel":if(!a.originalEvent)break;if(!a.originalEvent.wheelDelta)break;("down"===c&&0>a.originalEvent.wheelDelta||"up"===c&&0<a.originalEvent.wheelDelta)&&
a.preventDefault()}};b.prototype.createEvents=function(){var a=this;this.events={down:function(c){a.isBeingDragged=!0;a.offsetY=c.clientY-a.slider.offset().top;a.pane.addClass("active");a.doc.bind("mousemove",a.events.drag).bind("mouseup",a.events.up);return!1},drag:function(c){a.sliderY=c.clientY-a.el.offset().top-a.offsetY;a.scroll();return!1},up:function(){a.isBeingDragged=!1;a.pane.removeClass("active");a.doc.unbind("mousemove",a.events.drag).unbind("mouseup",a.events.up);return!1},resize:function(){a.reset()},
panedown:function(c){a.sliderY=c.offsetY-0.5*a.sliderHeight;a.scroll();a.events.down(c);return!1},scroll:function(c){var b,g,e;a.isBeingDragged||(b=a.content[0].scrollHeight-a.content[0].clientHeight,e=a.content[0].scrollTop,g=a.paneHeight-a.sliderHeight,a.slider.css({top:e*g/b}),null!=c&&(e>=b?(a.options.preventPageScrolling&&a.preventScrolling(c,"down"),a.el.trigger("scrollend")):0===e&&(a.options.preventPageScrolling&&a.preventScrolling(c,"up"),a.el.trigger("scrolltop"))))},wheel:function(c){if(null!=
c)return a.sliderY+=-c.wheelDeltaY||-c.delta,a.scroll(),!1}}};b.prototype.addEvents=function(){var a;a=this.events;this.options.disableResize||this.win.bind("resize",a.resize);this.slider.bind("mousedown",a.down);this.pane.bind("mousedown",a.panedown).bind("mousewheel",a.wheel).bind("DOMMouseScroll",a.wheel);this.content.bind("mousewheel",a.scroll).bind("DOMMouseScroll",a.scroll).bind("touchmove",a.scroll)};b.prototype.removeEvents=function(){var a;a=this.events;this.options.disableResize||this.win.unbind("resize",
a.resize);this.slider.unbind("mousedown",a.down);this.pane.unbind("mousedown",a.panedown).unbind("mousewheel",a.wheel).unbind("DOMMouseScroll",a.wheel);this.content.unbind("mousewheel",a.scroll).unbind("DOMMouseScroll",a.scroll).unbind("touchmove",a.scroll)};b.prototype.generate=function(){var a,c,b,g,e;b=this.options;g=b.paneClass;e=b.sliderClass;a=b.contentClass;this.el.append('<div class="'+g+'"><div class="'+e+'" /></div>');this.content=f(this.el.children("."+a)[0]);this.slider=this.el.find("."+
e);this.pane=this.el.find("."+g);h&&(c={right:-h},this.el.addClass("has-scrollbar"));b.iOSNativeScrolling&&(null==c&&(c={}),c.WebkitOverflowScrolling="touch");null!=c&&this.content.css(c);return this};b.prototype.elementsExist=function(){return this.el.find("."+this.options.paneClass).length};b.prototype.restore=function(){this.stopped=!1;this.pane.show();return this.addEvents()};b.prototype.reset=function(){var a,b,f,g,e,i,d;this.elementsExist()||this.generate().stop();this.stopped&&this.restore();
a=this.content[0];f=a.style;g=f.overflowY;l&&this.content.css({height:this.content.height()});b=a.scrollHeight+h;i=this.pane.outerHeight();d=parseInt(this.pane.css("top"),10);e=parseInt(this.pane.css("bottom"),10);e=i+d+e;d=Math.round(e/b*e);d=d>this.options.sliderMinHeight?d:this.options.sliderMinHeight;"scroll"===g&&"scroll"!==f.overflowX&&(d+=h);this.contentHeight=b;this.paneHeight=i;this.paneOuterHeight=e;this.sliderHeight=d;this.maxSliderTop=e-d;this.slider.height(d);this.events.scroll();this.pane.show();
this.paneOuterHeight>=a.scrollHeight&&"scroll"!==g?this.pane.hide():this.el.height()===a.scrollHeight&&"scroll"===g?this.slider.hide():this.slider.show();return this};b.prototype.scroll=function(){this.sliderY=Math.max(0,this.sliderY);this.sliderY=Math.min(this.maxSliderTop,this.sliderY);this.content.scrollTop(-1*((this.paneHeight-this.contentHeight+h)*this.sliderY/this.maxSliderTop));this.slider.css({top:this.sliderY});return this};b.prototype.scrollBottom=function(a){this.reset();this.content.scrollTop(this.contentHeight-
this.content.height()-a).trigger("mousewheel");return this};b.prototype.scrollTop=function(a){this.reset();this.content.scrollTop(+a).trigger("mousewheel");return this};b.prototype.scrollTo=function(a){this.reset();a=f(a).offset().top;a>this.maxSliderTop&&(a/=this.contentHeight,this.sliderY=a*=this.maxSliderTop,this.scroll());return this};b.prototype.stop=function(){this.stopped=!0;this.removeEvents();this.pane.hide();return this};return b}();f.fn.nanoScroller=function(b){var a,c,h,g,e,i;null!=b&&
(h=b.scrollBottom,e=b.scrollTop,g=b.scrollTo,c=b.scroll,i=b.stop);a=f.extend({},n,b);this.each(function(){var d;if(d=f.data(this,"scrollbar"))f.extend(d.options,b);else{d=new m(this,a);f.data(this,"scrollbar",d)}return h?d.scrollBottom(h):e?d.scrollTop(e):g?d.scrollTo(g):c==="bottom"?d.scrollBottom(0):c==="top"?d.scrollTop(0):c instanceof f?d.scrollTo(c):i?d.stop():d.reset()})}})(jQuery,window,document);